<?php

// --------------------------------------------------------------------------
namespace App\Models;
use Illuminate\Database\Eloquent\Model;
// --------------------------------------------------------------------------
use App\Models\Project as Project;
use App\Models\OtherAdditionalQaCheck as Question;
// --------------------------------------------------------------------------

// --------------------------------------------------------------------------
class PjAdditionalQa extends Model {
    // ----------------------------------------------------------------------
    protected $fillable = [
        'project_id',
        'question_id',
        'answer'
    ];
    // ----------------------------------------------------------------------
    // protected $appends = [ 'answers' ];
    // ----------------------------------------------------------------------

    // ----------------------------------------------------------------------
    // Answer accessor 
    // This will decode the data if the original answer is in JSON
    // ----------------------------------------------------------------------
    public function getAnswerAttribute( $value ){
        // ------------------------------------------------------------------
        // If empty array is saved, eturn an actual empty array.
        // json_decode somehow parses "[]" as Null.
        // ------------------------------------------------------------------
        if( '[]' == $value ) return array();
        // ------------------------------------------------------------------
        $json = json_decode( $value );
        return $json ? $json : $value;
        // ------------------------------------------------------------------
    }
    // ----------------------------------------------------------------------

    // ----------------------------------------------------------------------
    public function project(){
        return $this->belongsTo( Project::class );
    }
    // ----------------------------------------------------------------------

    // ----------------------------------------------------------------------
    public function question(){
        return $this->belongsTo( Question::class, 'question_id' );
    }
    // ----------------------------------------------------------------------
}
// --------------------------------------------------------------------------
