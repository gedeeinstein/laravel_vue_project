<?php
// --------------------------------------------------------------------------
namespace App\Models;
use Illuminate\Database\Eloquent\Model;
// --------------------------------------------------------------------------
use App\Models\User;
use App\Models\Project;
use App\Models\MasterValue;
use App\Models\PjSheet as Sheet;
// --------------------------------------------------------------------------

// --------------------------------------------------------------------------
class RequestInspection extends Model {
    // ----------------------------------------------------------------------
    protected $guarded = array( 'id' );
    protected $appends = array( 'type' );
    // ----------------------------------------------------------------------

    // ----------------------------------------------------------------------
    public function project(){
        return $this->belongsTo( Project::class );
    }
    // ----------------------------------------------------------------------

    // ----------------------------------------------------------------------
    public function user(){
        return $this->belongsTo( User::class );
    }
    // ----------------------------------------------------------------------

    // ----------------------------------------------------------------------
    // Relation to pj sheet
    // ----------------------------------------------------------------------
    public function sheet(){
        return $this->belongsTo( Sheet::class, 'sheet_id' );
    }
    // ----------------------------------------------------------------------

    // ----------------------------------------------------------------------
    public function getTypeAttribute(){
        $query = MasterValue::where( 'type', 'request_inspection_kind' );
        return $query->where( 'key', $this->kind )->first();
    }
    // ----------------------------------------------------------------------
}
// --------------------------------------------------------------------------
