<?php
// --------------------------------------------------------------------------
use App\Models\MasterValue;
use App\Models\PjSheetCalculate;
// --------------------------------------------------------------------------
use Carbon\Carbon;
use Illuminate\Database\Seeder;
use Faker\Factory as Faker;
// --------------------------------------------------------------------------

// --------------------------------------------------------------------------
class PjSheetCalculateSeeder extends Seeder {
    // ----------------------------------------------------------------------
    // Preset data
    // ----------------------------------------------------------------------
    public function dataset(){
        return array(
            // --------------------------------------------------------------
            array( 'key' => 1001, 'serial' => 'G41-1', 'default' => 40000, 'value' => 40000 ),
            array( 'key' => 1002, 'serial' => 'G41-2', 'default' => 50000, 'value' => 50000 ),
            array( 'key' => 1003, 'serial' => 'G41-3', 'default' => 60000, 'value' => 60000 ),
            // --------------------------------------------------------------
            array( 'key' => 2001, 'serial' => 'G41-4', 'default' => 900000, 'value' => 900000 ),
            // --------------------------------------------------------------
            array( 'key' => 3001, 'serial' => 'G41-5', 'default' => 6000, 'value' => 6000 ),
            // --------------------------------------------------------------
            array( 'key' => 4001, 'serial' => 'G41-6', 'default' => 12000, 'value' => 12000 ),
            array( 'key' => 4002, 'serial' => 'G41-7', 'default' => 100000, 'value' => 100000 ),
            array( 'key' => 4003, 'serial' => 'G41-8', 'default' => 17500, 'value' => 17500 ),
            array( 'key' => 4004, 'serial' => 'G41-9', 'default' => 100000, 'value' => 100000 ),
            array( 'key' => 4005, 'serial' => 'G41-10', 'default' => 19800, 'value' => 19800 ),
            array( 'key' => 4006, 'serial' => 'G41-11', 'default' => 100000, 'value' => 100000 ),
            array( 'key' => 4007, 'serial' => 'G41-12', 'default' => 26800, 'value' => 26800 ),
            array( 'key' => 4008, 'serial' => 'G41-13', 'default' => 150000, 'value' => 150000 ),
            array( 'key' => 4009, 'serial' => 'G41-14', 'default' => 32500, 'value' => 32500 ),
            array( 'key' => 4010, 'serial' => 'G41-15', 'default' => 150000, 'value' => 150000 ),
            array( 'key' => 4011, 'serial' => 'G41-16', 'default' => 49800, 'value' => 49800 ),
            array( 'key' => 4012, 'serial' => 'G41-17', 'default' => 200000, 'value' => 200000 ),
            // --------------------------------------------------------------
            array( 'key' => 5001, 'serial' => 'G41-20', 'default' => 4000, 'value' => 4000 ),
            array( 'key' => 5002, 'serial' => 'G41-21', 'default' => 100000, 'value' => 100000 ),
            // --------------------------------------------------------------
            array( 'key' => 6001, 'serial' => 'G41-22', 'default' => 13000, 'value' => 13000 ),
            array( 'key' => 6002, 'serial' => 'G41-23', 'default' => 50000, 'value' => 50000 ),
            array( 'key' => 6003, 'serial' => 'G41-24', 'default' => 26000, 'value' => 26000 ),
            array( 'key' => 6004, 'serial' => 'G41-25', 'default' => 50000, 'value' => 50000 ),
            // --------------------------------------------------------------
            array( 'key' => 7001, 'serial' => 'G41-26', 'default' => 40000, 'value' => 40000 ),
            array( 'key' => 7002, 'serial' => 'G41-27', 'default' => 50000, 'value' => 50000 ),
            array( 'key' => 7003, 'serial' => 'G41-28', 'default' => 60000, 'value' => 60000 ),
            array( 'key' => 7004, 'serial' => 'G41-29', 'default' => 70000, 'value' => 70000 ),
            // --------------------------------------------------------------
            array( 'key' => 8001, 'serial' => 'G41-30', 'default' => 55000, 'value' => 55000 ),
            array( 'key' => 8002, 'serial' => 'G41-31', 'default' => 65000, 'value' => 65000 ),
            array( 'key' => 8003, 'serial' => 'G41-32', 'default' => 75000, 'value' => 75000 ),
            array( 'key' => 8004, 'serial' => 'G41-33', 'default' => 85000, 'value' => 85000 ),
            // --------------------------------------------------------------
            array( 'key' => 9001, 'serial' => 'G41-34', 'default' => 25000, 'value' => 25000 ),
            // --------------------------------------------------------------
            array( 'key' => 10001, 'serial' => 'G41-35', 'default' => 750000, 'value' => 750000 ),
            // --------------------------------------------------------------
            array( 'key' => 11001, 'serial' => 'G41-36', 'default' => 1500, 'value' => 1500 )
            // --------------------------------------------------------------
        );
    }
    // ----------------------------------------------------------------------


    // ----------------------------------------------------------------------
    // Run the seeder
    // ----------------------------------------------------------------------
    public function run(){
        // ------------------------------------------------------------------
        $dataset = $this->dataset();
        if( !empty( $dataset )) foreach( $dataset as $entry ){
            // --------------------------------------------------------------
            $entry = (object) $entry;
            $model = new PjSheetCalculate(); // Create new model
            // --------------------------------------------------------------
            if( !empty( $entry->key )){
                // ----------------------------------------------------------
                // Get the reference master values field
                // ----------------------------------------------------------
                $query = MasterValue::where( 'type', 'pj_sheet_calculate_field' );
                $field = $query->where( 'key', $entry->key )->first();
                // ----------------------------------------------------------
                if( $field ){
                    // ------------------------------------------------------
                    $model->value = 0;
                    $model->field_id = $field->id;
                    // ------------------------------------------------------

                    // ------------------------------------------------------
                    // Set serial for easier referencing
                    // ------------------------------------------------------
                    if( !empty( $entry->serial )) $model->serial = $entry->serial;
                    // ------------------------------------------------------

                    // ------------------------------------------------------
                    // Set the initial & default value
                    // ------------------------------------------------------
                    if( !empty( $entry->value )) $model->value = $entry->value;
                    if( !empty( $entry->default )) $model->default_value = $entry->default;
                    // ------------------------------------------------------
                }
                // ----------------------------------------------------------
            }
            // --------------------------------------------------------------
            $model->save(); // Save the updates
            // --------------------------------------------------------------
        }
        // ------------------------------------------------------------------
    }
}
// --------------------------------------------------------------------------